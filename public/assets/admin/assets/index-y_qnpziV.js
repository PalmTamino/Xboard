import{j as e,r as _,a as g,g as f,B as y,t as S}from"./index-ra1jmRmU.js";import{S as v}from"./separator-Ckt7QEUw.js";import{z as n,t as N}from"./zod-DftZp2aV.js";import{u as C,F,a as l,b as t,c as o,d as c,f as a,e as d}from"./form-BdPgCkkB.js";import{I as j}from"./input-BJSapCFH.js";import{S as m}from"./switch-koO8JJ-3.js";import{C as L}from"./react-icons.esm-BRv52UVg.js";import{u}from"./useQuery-BPONQpNy.js";import{s as T,e as O,f as R}from"./index-vL3ySUIK.js";import{S as U}from"./config-BH6RmWlb.js";import"./index-QSXu8nGm.js";import"./index-OwEZQf1t.js";import"./index-DGqrqZGX.js";import"./index-NvRyusV4.js";import"./clipboard-Bl2zvJsv.js";import"./IconTicket-s_6DwrCY.js";function E({title:x,description:h,children:s}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium",children:x}),e.jsx("p",{className:"text-sm text-muted-foreground",children:h})]}),e.jsx(v,{}),s]})}const k=n.object({logo:n.string().nullable().nullable(),force_https:n.number().nullable(),stop_register:n.number().nullable(),app_name:n.string().nullable(),app_description:n.string().nullable(),app_url:n.string().nullable(),subscribe_url:n.string().nullable(),try_out_plan_id:n.number().nullable(),try_out_hour:n.number().nullable(),tos_url:n.string().nullable(),currency:n.string().nullable(),currency_symbol:n.string().nullable()}),w={logo:"",force_https:0,stop_register:0,app_name:"",app_description:"",app_url:"",subscribe_url:"",try_out_plan_id:0,try_out_hour:0,tos_url:"",currency:"USD",currency_symbol:"$"};function I(){const{data:x}=u({queryKey:["settings","site"],queryFn:()=>O("site")}),{data:h}=u({queryKey:["plans"],queryFn:()=>R()}),s=C({resolver:N(k),defaultValues:w,mode:"onChange"});_.useEffect(()=>{if(x?.data?.site){const r=x?.data?.site;Object.entries(r).forEach(([i,b])=>{s.setValue(i,b)})}},[x]);function p(r){T(r).then(({data:i})=>{i&&S.success("更新成功")})}return e.jsx(F,{...s,children:e.jsxs("form",{onSubmit:s.handleSubmit(p),className:"space-y-8",children:[e.jsx(l,{control:s.control,name:"app_name",render:({field:r})=>e.jsxs(t,{children:[e.jsx(o,{children:"站点名称"}),e.jsx(c,{children:e.jsx(j,{placeholder:"请输入站点名称",...r})}),e.jsx(a,{children:"用于显示需要站点名称的地方。"}),e.jsx(d,{})]})}),e.jsx(l,{control:s.control,name:"app_description",render:({field:r})=>e.jsxs(t,{children:[e.jsx(o,{children:"站点描述"}),e.jsx(c,{children:e.jsx(j,{placeholder:"请输入站点描述",...r})}),e.jsx(a,{children:"用于显示需要站点名称的地方。"}),e.jsx(d,{})]})}),e.jsx(l,{control:s.control,name:"app_url",render:({field:r})=>e.jsxs(t,{children:[e.jsx(o,{children:"站点网址"}),e.jsx(c,{children:e.jsx(j,{placeholder:"请输入站点URL，末尾不要/",...r})}),e.jsx(a,{children:"当前网站最新网址，将会在邮件等需要用于网址处体现。"}),e.jsx(d,{})]})}),e.jsx(l,{control:s.control,name:"force_https",render:({field:r})=>e.jsxs(t,{children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(o,{className:"text-base",children:"强制HTTPS"}),e.jsx(a,{children:"当站点没有使用HTTPS，CDN或反代开启强制HTTPS时需要开启。"})]}),e.jsx(c,{children:e.jsx(m,{checked:r.value,onCheckedChange:r.onChange})})]})}),e.jsx(l,{control:s.control,name:"logo",render:({field:r})=>e.jsxs(t,{children:[e.jsx(o,{children:"LOGO"}),e.jsx(c,{children:e.jsx(j,{placeholder:"请输入LOGO URL，末尾不要/",...r})}),e.jsx(a,{children:"用于显示需要LOGO的地方。"}),e.jsx(d,{})]})}),e.jsx(l,{control:s.control,name:"subscribe_url",render:({field:r})=>e.jsxs(t,{children:[e.jsx(o,{children:"订阅URL"}),e.jsx(c,{children:e.jsx(j,{placeholder:'用于订阅所使用，多个订阅地址用","隔开.留空则为站点URL。',...r})}),e.jsx(a,{children:"用于订阅所使用，留空则为站点URL。"}),e.jsx(d,{})]})}),e.jsx(l,{control:s.control,name:"tos_url",render:({field:r})=>e.jsxs(t,{children:[e.jsx(o,{children:"用户条款(TOS)URL"}),e.jsx(c,{children:e.jsx(j,{placeholder:"请输入用户条款URL，末尾不要/",...r})}),e.jsx(a,{children:"用于跳转到用户条款(TOS)"}),e.jsx(d,{})]})}),e.jsx(l,{control:s.control,name:"stop_register",render:({field:r})=>e.jsxs(t,{children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(o,{className:"text-base",children:"停止新用户注册"}),e.jsx(a,{children:"开启后任何人都将无法进行注册。"})]}),e.jsx(c,{children:e.jsx(m,{checked:r.value,onCheckedChange:r.onChange})})]})}),e.jsx(l,{control:s.control,name:"try_out_plan_id",render:({field:r})=>e.jsxs(t,{children:[e.jsx(o,{children:"注册试用"}),e.jsxs("div",{className:"relative w-max",children:[e.jsx(c,{children:e.jsxs("select",{className:g(f({variant:"outline"}),"w-[200px] appearance-none font-normal"),...r,value:r.value||0,onChange:i=>r.onChange(Number(i.target.value)),children:[e.jsx("option",{value:0,children:"关闭"}),h?.data?.map(i=>e.jsx("option",{value:i.id,children:i.name},i.id))]})}),e.jsx(L,{className:"absolute right-3 top-2.5 h-4 w-4 opacity-50"})]}),e.jsx(a,{children:"选择需要试用的订阅，如果没有选项请先前往订阅管理添加。"}),e.jsx(d,{})]})}),e.jsx(l,{control:s.control,name:"currency",render:({field:r})=>e.jsxs(t,{children:[e.jsx(o,{children:"货币单位"}),e.jsx(c,{children:e.jsx(j,{placeholder:"CNY",...r})}),e.jsx(a,{children:"仅用于展示使用，更改后系统中所有的货币单位都将发生变更。"}),e.jsx(d,{})]})}),e.jsx(l,{control:s.control,name:"currency_symbol",render:({field:r})=>e.jsxs(t,{children:[e.jsx(o,{children:"货币符号"}),e.jsx(c,{children:e.jsx(j,{placeholder:"¥",...r})}),e.jsx(a,{children:"仅用于展示使用，更改后系统中所有的货币单位都将发生变更。"}),e.jsx(d,{})]})}),e.jsx(y,{type:"submit",children:"更新配置"})]})})}function X(){const x=U.find(h=>h.key==="site");return e.jsx(E,{title:x.title,description:x.description,children:e.jsx(I,{})})}export{X as default};
