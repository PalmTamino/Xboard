import{r as d,j as e,B as h,t as O}from"./index-ra1jmRmU.js";import{D as I,e as _,a as T,b as V,c as L,d as P,f as k}from"./button-BkBuHKqj.js";import{z as n,t as y}from"./zod-DftZp2aV.js";import{u as E,F as N,a as o,b as l,c as t,d as i,e as w}from"./form-BdPgCkkB.js";import{I as j}from"./input-BJSapCFH.js";import{b as z}from"./react-icons.esm-BRv52UVg.js";import{f as A,a7 as B}from"./index-vL3ySUIK.js";import{S as u,a as p,b as g,c as f,d as C}from"./select-ar7QGfF7.js";import{e as F}from"./index-ngg4RcvF.js";const M=n.object({email:n.string().min(1),plan_id:n.number(),period:n.string(),total_amount:n.number()}),H={email:"",plan_id:0,total_amount:0,period:""};function Y({refetch:x,trigger:v,defaultValues:b}){const[c,m]=d.useState(!1),a=E({resolver:y(M),defaultValues:{...H,...b},mode:"onChange"}),[S,D]=d.useState([]);return d.useEffect(()=>{c&&A().then(({data:s})=>{D(s)})},[c]),e.jsxs(I,{open:c,onOpenChange:m,children:[e.jsx(_,{asChild:!0,children:v||e.jsxs(h,{variant:"outline",size:"sm",className:"ml-auto hidden h-8 lg:flex",children:[e.jsx(z,{className:"mr-2 h-4 w-4"}),"添加订单"]})}),e.jsxs(T,{className:"sm:max-w-[425px]",children:[e.jsxs(V,{children:[e.jsx(L,{children:"订单分配"}),e.jsx(P,{})]}),e.jsxs(N,{...a,children:[e.jsx(o,{control:a.control,name:"email",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"用户邮箱"}),e.jsx(i,{children:e.jsx(j,{placeholder:"请输入用户邮箱",...s})})]})}),e.jsx(o,{control:a.control,name:"plan_id",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"订阅计划"}),e.jsx(i,{children:e.jsxs(u,{value:s.value?s.value?.toString():void 0,onValueChange:r=>s.onChange(parseInt(r)),children:[e.jsx(p,{children:e.jsx(g,{placeholder:"请选择订阅计划"})}),e.jsx(f,{children:S.map(r=>e.jsx(C,{value:r.id.toString(),children:r.name},r.id))})]})})]})}),e.jsx(o,{control:a.control,name:"period",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"订阅时长"}),e.jsx(i,{children:e.jsxs(u,{value:s.value,onValueChange:s.onChange,children:[e.jsx(p,{children:e.jsx(g,{placeholder:"请选择购买时长"})}),e.jsx(f,{children:Object.keys(F).map(r=>e.jsx(C,{value:r,children:F[r]},r))})]})})]})}),e.jsx(o,{control:a.control,name:"total_amount",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"支付金额"}),e.jsx(i,{children:e.jsx(j,{type:"number",placeholder:"请输入需要支付的金额",value:s.value/100,onChange:r=>s.onChange(parseFloat(r.currentTarget.value)*100)})}),e.jsx(w,{})]})}),e.jsxs(k,{children:[e.jsx(h,{variant:"outline",onClick:()=>m(!1),children:"取消"}),e.jsx(h,{type:"submit",onClick:()=>{a.handleSubmit(s=>{B(s).then(({data:r})=>{r&&(x&&x(),a.reset(),m(!1),O.success("添加成功"))})})()},children:"确定"})]})]})]})]})}export{Y as O};
