import{r as b,j as e,a as d,g as h,B as v,t as f}from"./index-_xd8OyP8.js";import{S as g}from"./separator-lX8UNwTG.js";import{z as r,t as N}from"./zod-x_8lkCGK.js";import{C as x}from"./react-icons.esm-rZq2pt7A.js";import{u as w,F as C,a,b as l,c as o,f as c,d as t,e as m}from"./form-DIzSOdtk.js";import{S as i}from"./switch-w5WyeRwk.js";import{u as y}from"./useQuery-mr7Ep0hT.js";import{e as F,s as S}from"./index-BycJudEO.js";import"./index-CX6PQ3zO.js";import"./index-BwSRHYe4.js";import"./index-CRh0M8qI.js";import"./index-BlMNiBlp.js";import"./clipboard-YH5zrf5X.js";const k=r.object({plan_change_enable:r.boolean().nullable(),reset_traffic_method:r.coerce.number().nullable(),surplus_enable:r.boolean().nullable(),new_order_event_id:r.coerce.number().nullable(),renew_order_event_id:r.coerce.number().nullable(),change_order_event_id:r.coerce.number().nullable(),show_info_to_server_enable:r.boolean().nullable(),show_protocol_to_server_enable:r.boolean().nullable(),default_remind_expire:r.boolean().nullable(),default_remind_traffic:r.boolean().nullable()}),E={plan_change_enable:!1,reset_traffic_method:0,surplus_enable:!1,new_order_event_id:0,renew_order_event_id:0,change_order_event_id:0,show_info_to_server_enable:!1,show_protocol_to_server_enable:!1,default_remind_expire:!1,default_remind_traffic:!1};function V(){const{data:j}=y({queryKey:["settings","subscribe"],queryFn:()=>F("subscribe")}),n=w({resolver:N(k),defaultValues:E,mode:"onChange"});b.useEffect(()=>{if(j?.data?.subscribe){const s=j?.data?.subscribe;Object.entries(s).forEach(([u,p])=>{n.setValue(u,p)})}},[j]);function _(s){S(s).then(({data:u})=>{u&&f.success("更新成功")})}return e.jsx(C,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(_),className:"space-y-8",children:[e.jsx(a,{control:n.control,name:"plan_change_enable",render:({field:s})=>e.jsxs(l,{children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(o,{className:"text-base",children:"允许用户更改订阅"}),e.jsx(c,{children:"开启后用户将会可以对订阅计划进行变更。"})]}),e.jsx(t,{children:e.jsx(i,{checked:s.value,onCheckedChange:s.onChange})})]})}),e.jsx(a,{control:n.control,name:"reset_traffic_method",render:({field:s})=>e.jsxs(l,{children:[e.jsx(o,{children:"月流量重置方式"}),e.jsxs("div",{className:"relative w-max",children:[e.jsx(t,{children:e.jsxs("select",{className:d(h({variant:"outline"}),"w-[200px] appearance-none font-normal"),...s,children:[e.jsx("option",{value:"0",children:"每月1号"}),e.jsx("option",{value:"1",children:"按月重置"}),e.jsx("option",{value:"2",children:"不重置"}),e.jsx("option",{value:"3",children:"每年1月1号"}),e.jsx("option",{value:"4",children:"按年重置"})]})}),e.jsx(x,{className:"absolute right-3 top-2.5 h-4 w-4 opacity-50"})]}),e.jsx(c,{children:"全局流量重置方式，默认每月1号。可以在订阅管理为订阅单独设置。"}),e.jsx(m,{})]})}),e.jsx(a,{control:n.control,name:"surplus_enable",render:({field:s})=>e.jsxs(l,{children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(o,{className:"text-base",children:"开启折抵方案"}),e.jsx(c,{children:"开启后用户更换订阅将会由系统对原有订阅进行折抵，方案参考文档。"})]}),e.jsx(t,{children:e.jsx(i,{checked:s.value,onCheckedChange:s.onChange})})]})}),e.jsx(a,{control:n.control,name:"new_order_event_id",render:({field:s})=>e.jsxs(l,{children:[e.jsx(o,{children:"当订阅新购时触发事件"}),e.jsxs("div",{className:"relative w-max",children:[e.jsx(t,{children:e.jsxs("select",{className:d(h({variant:"outline"}),"w-[200px] appearance-none font-normal"),...s,children:[e.jsx("option",{value:"0",children:"不执行任何动作"}),e.jsx("option",{value:"1",children:"重置用户流量"})]})}),e.jsx(x,{className:"absolute right-3 top-2.5 h-4 w-4 opacity-50"})]}),e.jsx(c,{children:"新购订阅完成时将触发该任务。"}),e.jsx(m,{})]})}),e.jsx(a,{control:n.control,name:"renew_order_event_id",render:({field:s})=>e.jsxs(l,{children:[e.jsx(o,{children:"当订阅续费时触发事件"}),e.jsxs("div",{className:"relative w-max",children:[e.jsx(t,{children:e.jsxs("select",{className:d(h({variant:"outline"}),"w-[200px] appearance-none font-normal"),...s,children:[e.jsx("option",{value:"0",children:"不执行任何动作"}),e.jsx("option",{value:"1",children:"重置用户流量"})]})}),e.jsx(x,{className:"absolute right-3 top-2.5 h-4 w-4 opacity-50"})]}),e.jsx(c,{children:"续费订阅完成时将触发该任务。"}),e.jsx(m,{})]})}),e.jsx(a,{control:n.control,name:"change_order_event_id",render:({field:s})=>e.jsxs(l,{children:[e.jsx(o,{children:"当订阅变更时触发事件"}),e.jsxs("div",{className:"relative w-max",children:[e.jsx(t,{children:e.jsxs("select",{className:d(h({variant:"outline"}),"w-[200px] appearance-none font-normal"),...s,children:[e.jsx("option",{value:"0",children:"不执行任何动作"}),e.jsx("option",{value:"1",children:"重置用户流量"})]})}),e.jsx(x,{className:"absolute right-3 top-2.5 h-4 w-4 opacity-50"})]}),e.jsx(c,{children:"变更订阅完成时将触发该任务。"}),e.jsx(m,{})]})}),e.jsx(a,{control:n.control,name:"show_info_to_server_enable",render:({field:s})=>e.jsxs(l,{children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(o,{className:"text-base",children:"在订阅中展示订阅信息"}),e.jsx(c,{children:"开启后将会在用户订阅节点时输出订阅信息。"})]}),e.jsx(t,{children:e.jsx(i,{checked:s.value,onCheckedChange:s.onChange})})]})}),e.jsx(a,{control:n.control,name:"show_protocol_to_server_enable",render:({field:s})=>e.jsxs(l,{children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(o,{className:"text-base",children:"在订阅中线路名称中显示协议名称"}),e.jsx(c,{children:"开启后订阅线路会附带协议名称（例如: [Hy2]香港）"})]}),e.jsx(t,{children:e.jsx(i,{checked:s.value,onCheckedChange:s.onChange})})]})}),e.jsx(a,{control:n.control,name:"default_remind_expire",render:({field:s})=>e.jsxs(l,{children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(o,{className:"text-base",children:"用户订阅到期提醒的默认设置"}),e.jsx(c,{children:"开启后新注册用户将默认接收订阅到期提醒。"})]}),e.jsx(t,{children:e.jsx(i,{checked:s.value,onCheckedChange:s.onChange})})]})}),e.jsx(a,{control:n.control,name:"default_remind_traffic",render:({field:s})=>e.jsxs(l,{children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(o,{className:"text-base",children:"用户流量告急提醒的默认设置"}),e.jsx(c,{children:"开启后新注册用户将默认接收流量告急提醒。"})]}),e.jsx(t,{children:e.jsx(i,{checked:s.value,onCheckedChange:s.onChange})})]})}),e.jsx(v,{type:"submit",children:"保存设置"})]})})}function G(){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium",children:"订阅设置"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"管理用户订阅相关配置，包括订阅链接格式、更新频率、流量统计等设置。"})]}),e.jsx(g,{}),e.jsx(V,{})]})}export{G as default};
