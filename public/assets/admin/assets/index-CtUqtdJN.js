import{j as e,B,a as u,r as d,t as H,L as G,w as Y}from"./index-ra1jmRmU.js";import{C as Q,a as J,b as W,d as X,e as P,f as R,g as ee,S as se,T as ae,U as le}from"./user-nav-Ch7kI57y.js";import{D as te,a as re,b as ne,e as h,L as ie,f as oe,g as ce}from"./sidelinks-B70MVRK0.js";import{B as j,D as o,u as de,g as me,b as ue,c as xe,d as he,e as ge,f as je,a as fe}from"./column-header-p2OHlx2E.js";import{u as pe}from"./useQuery-BPONQpNy.js";import{b as ve,c as be,a as Ne}from"./react-icons.esm-BRv52UVg.js";import{I as N}from"./input-BJSapCFH.js";import{P as I,a as E,b as $,c as we}from"./popover-C64Crl1x.js";import{S as ye}from"./separator-Ckt7QEUw.js";import{D as Ce,e as Se,B as m,a as _e,b as Fe,c as De,d as Me,f as Te}from"./button-BkBuHKqj.js";import{C as Ve,b as Le}from"./calendar-BSDjNVAZ.js";import{u as Pe,F as Re,b as v,c as b,a as f,e as Ue,d as U}from"./form-BdPgCkkB.js";import{S as ke,a as ze,b as Ae,c as Be,d as k}from"./select-ar7QGfF7.js";import{a as w,b as S,d as z,c as He}from"./common-DR9A_A8_.js";import{z as g,t as Ie}from"./zod-DftZp2aV.js";import{f as Ee,a4 as $e,a5 as Ke,I as Oe,a6 as Ze}from"./index-vL3ySUIK.js";import{u as qe}from"./index-ngg4RcvF.js";import{U as Ge,T as Ye}from"./traffic-record-table-DyDdLbR3.js";import{O as Qe}from"./order-assign-form-SPO5KUlu.js";import{T as _,a as F,b as D,c as M}from"./tooltip-uHmd8Pkm.js";import{E as Je}from"./ellipsis-DT9T1PvG.js";import"./index-CmmzV1O3.js";import"./index-OwEZQf1t.js";import"./index-QSXu8nGm.js";import"./index-NvRyusV4.js";import"./IconTicket-s_6DwrCY.js";import"./arrow-up-Cu4ezgY6.js";import"./index-DGqrqZGX.js";import"./index-DBonxKbv.js";import"./clipboard-Bl2zvJsv.js";import"./switch-koO8JJ-3.js";import"./textarea-C2MOf6wm.js";import"./skeleton-Dl8LFgxA.js";function A({column:t,title:c,options:s}){const a=t?.getFacetedUniqueValues(),r=new Set(t?.getFilterValue());return e.jsxs(I,{children:[e.jsx(E,{asChild:!0,children:e.jsxs(B,{variant:"outline",size:"sm",className:"h-8 border-dashed",children:[e.jsx(ve,{className:"mr-2 h-4 w-4"}),c,r?.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(ye,{orientation:"vertical",className:"mx-2 h-4"}),e.jsx(j,{variant:"secondary",className:"rounded-sm px-1 font-normal lg:hidden",children:r.size}),e.jsx("div",{className:"hidden space-x-1 lg:flex",children:r.size>2?e.jsxs(j,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:[r.size," selected"]}):s.filter(n=>r.has(n.value)).map(n=>e.jsx(j,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:n.label},n.value))})]})]})}),e.jsx($,{className:"w-[200px] p-0",align:"start",children:e.jsxs(Q,{children:[e.jsx(J,{placeholder:c}),e.jsxs(W,{children:[e.jsx(X,{children:"No results found."}),e.jsx(P,{children:s.map(n=>{const l=r.has(n.value);return e.jsxs(R,{onSelect:()=>{l?r.delete(n.value):r.add(n.value);const i=Array.from(r);t?.setFilterValue(i.length?i:void 0)},children:[e.jsx("div",{className:u("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",l?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"),children:e.jsx(be,{className:u("h-4 w-4")})}),n.icon&&e.jsx(n.icon,{className:`mr-2 h-4 w-4 text-muted-foreground text-${n.color}`}),e.jsx("span",{children:n.label}),a?.get(n.value)&&e.jsx("span",{className:"ml-auto flex h-4 w-4 items-center justify-center font-mono text-xs",children:a.get(n.value)})]},n.value)})}),r.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(ee,{}),e.jsx(P,{children:e.jsx(R,{onSelect:()=>t?.setFilterValue(void 0),className:"justify-center text-center",children:"Clear filters"})})]})]})]})})]})}const We=t=>e.jsx("svg",{className:"inline-block",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...t,children:e.jsx("path",{fill:"currentColor",d:"M21 10.5h-1v-1a1 1 0 0 0-2 0v1h-1a1 1 0 0 0 0 2h1v1a1 1 0 0 0 2 0v-1h1a1 1 0 0 0 0-2m-7.7 1.72A4.92 4.92 0 0 0 15 8.5a5 5 0 0 0-10 0a4.92 4.92 0 0 0 1.7 3.72A8 8 0 0 0 2 19.5a1 1 0 0 0 2 0a6 6 0 0 1 12 0a1 1 0 0 0 2 0a8 8 0 0 0-4.7-7.28M10 11.5a3 3 0 1 1 3-3a3 3 0 0 1-3 3"})}),Xe=g.object({email_prefix:g.string().optional(),email_suffix:g.string().min(1),password:g.string().optional(),expired_at:g.number().optional().nullable(),plan_id:g.number().nullable(),generate_count:g.number().optional().nullable()}).refine(t=>t.generate_count===null?t.email_prefix!==void 0&&t.email_prefix!=="":!0,{message:"Email prefix is required when generate_count is null",path:["email_prefix"]}),es={email_prefix:"",email_suffix:"",password:"",expired_at:null,plan_id:null,generate_count:void 0};function ss({refetch:t}){const[c,s]=d.useState(!1),a=Pe({resolver:Ie(Xe),defaultValues:es,mode:"onChange"}),[r,n]=d.useState([]);return d.useEffect(()=>{c&&Ee().then(({data:l})=>{l&&n(l)})},[c]),e.jsxs(Ce,{open:c,onOpenChange:s,children:[e.jsx(Se,{asChild:!0,children:e.jsx(m,{variant:"outline",size:"icon",children:e.jsx(We,{})})}),e.jsxs(_e,{className:"sm:max-w-[425px]",children:[e.jsxs(Fe,{children:[e.jsx(De,{children:"创建用户"}),e.jsx(Me,{})]}),e.jsxs(Re,{...a,children:[e.jsxs(v,{children:[e.jsx(b,{children:"邮箱"}),e.jsxs("div",{className:"flex",children:[!a.watch("generate_count")&&e.jsx(f,{control:a.control,name:"email_prefix",render:({field:l})=>e.jsx(N,{className:"flex-[5] rounded-r-none",placeholder:"帐号(批量生成请留空)",...l})}),e.jsx("div",{className:`z-[-1] border border-r-0 border-input px-3 py-1 shadow-sm ${a.watch("generate_count")?"rounded-l-md":"border-l-0"}`,children:"@"}),e.jsx(f,{control:a.control,name:"email_suffix",render:({field:l})=>e.jsx(N,{className:"flex-[4] rounded-l-none",placeholder:"域",...l})})]})]}),e.jsx(f,{control:a.control,name:"password",render:({field:l})=>e.jsxs(v,{children:[e.jsx(b,{children:"密码"}),e.jsx(N,{placeholder:"留空则密码与邮件相同",...l}),e.jsx(Ue,{})]})}),e.jsx(f,{control:a.control,name:"expired_at",render:({field:l})=>e.jsxs(v,{className:"flex flex-col",children:[e.jsx(b,{children:"到期时间"}),e.jsxs(I,{children:[e.jsx(E,{asChild:!0,children:e.jsx(U,{children:e.jsxs(m,{variant:"outline",className:u("w-full pl-3 text-left font-normal",!l.value&&"text-muted-foreground"),children:[l.value?w(l.value):e.jsx("span",{children:"请选择用户到期日期，留空为长期有效"}),e.jsx(Ve,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),e.jsxs($,{className:"flex w-auto flex-col space-y-2 p-2",children:[e.jsx(we,{asChild:!0,children:e.jsx(m,{variant:"outline",className:"w-full",onClick:()=>{l.onChange(null)},children:"长期有效"})}),e.jsx("div",{className:"rounded-md border",children:e.jsx(Le,{mode:"single",selected:l.value?new Date(l.value*1e3):void 0,onSelect:i=>{i&&l.onChange(i?.getTime()/1e3)}})})]})]})]})}),e.jsx(f,{control:a.control,name:"plan_id",render:({field:l})=>e.jsxs(v,{children:[e.jsx(b,{children:"订阅计划"}),e.jsx(U,{children:e.jsxs(ke,{value:l.value?l.value.toString():"null",onValueChange:i=>l.onChange(i==="null"?null:parseInt(i)),children:[e.jsx(ze,{children:e.jsx(Ae,{placeholder:"无"})}),e.jsxs(Be,{children:[e.jsx(k,{value:"null",children:"无"}),r.map(i=>e.jsx(k,{value:i.id.toString(),children:i.name},i.id))]})]})})]})}),!a.watch("email_prefix")&&e.jsx(f,{control:a.control,name:"generate_count",render:({field:l})=>e.jsxs(v,{children:[e.jsx(b,{children:"生成数量"}),e.jsx(N,{type:"number",placeholder:"如果为批量生产请输入生成数量",value:l.value||"",onChange:i=>l.onChange(i.target.value?parseInt(i.target.value):null)})]})})]}),e.jsxs(Te,{children:[e.jsx(m,{variant:"outline",onClick:()=>s(!1),children:"取消"}),e.jsx(m,{onClick:()=>a.handleSubmit(l=>{$e(l).then(({data:i})=>{i&&(H.success("生成成功"),a.reset(),t(),s(!1))})})(),children:"生成"})]})]})]})}function as({table:t,refetch:c,serverGroupList:s}){const a=t.getState().columnFilters.length>0;return e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex flex-1 flex-wrap items-center gap-2",children:[e.jsx(N,{placeholder:"搜索用户邮箱...",value:t.getColumn("email")?.getFilterValue()??"",onChange:r=>t.getColumn("email")?.setFilterValue(r.target.value),className:"h-9 w-[150px] lg:w-[250px]"}),t.getColumn("banned")&&e.jsx(A,{column:t.getColumn("banned"),title:"用户状态",options:[{label:"正常",value:0},{label:"封禁",value:1}]}),t.getColumn("group_ids")&&e.jsx(A,{column:t.getColumn("group_ids"),title:"权限组",options:s.map(r=>({label:r.name,value:r.id}))}),a&&e.jsxs(B,{variant:"ghost",onClick:()=>t.resetColumnFilters(),className:"h-8 px-2 lg:px-3",children:["重置筛选",e.jsx(Ne,{className:"ml-2 h-4 w-4"})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(ss,{refetch:c})})]})}const ls=t=>e.jsx("svg",{className:"inline-block",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...t,children:e.jsx("path",{fill:"currentColor",d:"M5 18h4.24a1 1 0 0 0 .71-.29l6.92-6.93L19.71 8a1 1 0 0 0 0-1.42l-4.24-4.29a1 1 0 0 0-1.42 0l-2.82 2.83l-6.94 6.93a1 1 0 0 0-.29.71V17a1 1 0 0 0 1 1m9.76-13.59l2.83 2.83l-1.42 1.42l-2.83-2.83ZM6 13.17l5.93-5.93l2.83 2.83L8.83 16H6ZM21 20H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2"})}),ts=t=>e.jsx("svg",{className:"inline-block",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...t,children:e.jsx("path",{fill:"currentColor",d:"M19 11h-6V5a1 1 0 0 0-2 0v6H5a1 1 0 0 0 0 2h6v6a1 1 0 0 0 2 0v-6h6a1 1 0 0 0 0-2"})}),rs=t=>e.jsx("svg",{className:"inline-block",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...t,children:e.jsx("path",{fill:"currentColor",d:"M21 8.94a1.3 1.3 0 0 0-.06-.27v-.09a1 1 0 0 0-.19-.28l-6-6a1 1 0 0 0-.28-.19a.3.3 0 0 0-.09 0a.9.9 0 0 0-.33-.11H10a3 3 0 0 0-3 3v1H6a3 3 0 0 0-3 3v10a3 3 0 0 0 3 3h8a3 3 0 0 0 3-3v-1h1a3 3 0 0 0 3-3zm-6-3.53L17.59 8H16a1 1 0 0 1-1-1ZM15 19a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1V9a1 1 0 0 1 1-1h1v7a3 3 0 0 0 3 3h5Zm4-4a1 1 0 0 1-1 1h-8a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h3v3a3 3 0 0 0 3 3h3Z"})}),ns=t=>e.jsx("svg",{className:"inline-block",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...t,children:e.jsx("path",{fill:"currentColor",d:"M21 11a1 1 0 0 0-1 1a8.05 8.05 0 1 1-2.22-5.5h-2.4a1 1 0 0 0 0 2h4.53a1 1 0 0 0 1-1V3a1 1 0 0 0-2 0v1.77A10 10 0 1 0 22 12a1 1 0 0 0-1-1"})}),is=t=>e.jsx("svg",{className:"inline-block",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...t,children:e.jsx("path",{fill:"currentColor",d:"M9.5 10.5H12a1 1 0 0 0 0-2h-1V8a1 1 0 0 0-2 0v.55a2.5 2.5 0 0 0 .5 4.95h1a.5.5 0 0 1 0 1H8a1 1 0 0 0 0 2h1v.5a1 1 0 0 0 2 0v-.55a2.5 2.5 0 0 0-.5-4.95h-1a.5.5 0 0 1 0-1M21 12h-3V3a1 1 0 0 0-.5-.87a1 1 0 0 0-1 0l-3 1.72l-3-1.72a1 1 0 0 0-1 0l-3 1.72l-3-1.72a1 1 0 0 0-1 0A1 1 0 0 0 2 3v16a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-6a1 1 0 0 0-1-1M5 20a1 1 0 0 1-1-1V4.73l2 1.14a1.08 1.08 0 0 0 1 0l3-1.72l3 1.72a1.08 1.08 0 0 0 1 0l2-1.14V19a3 3 0 0 0 .18 1Zm15-1a1 1 0 0 1-2 0v-5h2Z"})}),os=t=>e.jsx("svg",{className:"inline-block",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...t,children:e.jsx("path",{fill:"currentColor",d:"M12.3 12.22A4.92 4.92 0 0 0 14 8.5a5 5 0 0 0-10 0a4.92 4.92 0 0 0 1.7 3.72A8 8 0 0 0 1 19.5a1 1 0 0 0 2 0a6 6 0 0 1 12 0a1 1 0 0 0 2 0a8 8 0 0 0-4.7-7.28M9 11.5a3 3 0 1 1 3-3a3 3 0 0 1-3 3m9.74.32A5 5 0 0 0 15 3.5a1 1 0 0 0 0 2a3 3 0 0 1 3 3a3 3 0 0 1-1.5 2.59a1 1 0 0 0-.5.84a1 1 0 0 0 .45.86l.39.26l.13.07a7 7 0 0 1 4 6.38a1 1 0 0 0 2 0a9 9 0 0 0-4.23-7.68"})}),cs=t=>e.jsx("svg",{className:"inline-block",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...t,children:e.jsx("path",{fill:"currentColor",d:"M12 2a10 10 0 0 0-6.88 2.77V3a1 1 0 0 0-2 0v4.5a1 1 0 0 0 1 1h4.5a1 1 0 0 0 0-2h-2.4A8 8 0 1 1 4 12a1 1 0 0 0-2 0A10 10 0 1 0 12 2m0 6a1 1 0 0 0-1 1v3a1 1 0 0 0 1 1h2a1 1 0 0 0 0-2h-1V9a1 1 0 0 0-1-1"})}),ds=(t,c)=>[{accessorKey:"id",header:({column:s})=>e.jsx(o,{column:s,title:"ID"}),cell:({row:s})=>e.jsx(j,{variant:"outline",children:s.original.id}),enableSorting:!0,enableHiding:!1},{accessorKey:"email",header:({column:s})=>e.jsx(o,{column:s,title:"邮箱"}),cell:({row:s})=>{const a=s.original.t||0,r=Date.now()/1e3-a<120,n=Math.floor(Date.now()/1e3-a);let l=r?"当前在线":a===0?"从未在线":`最后在线时间: ${w(a)}`;if(!r&&a!==0){const i=Math.floor(n/60),p=Math.floor(i/60),x=Math.floor(p/24);x>0?l+=`
离线时长: ${x}天`:p>0?l+=`
离线时长: ${p}小时`:i>0?l+=`
离线时长: ${i}分钟`:l+=`
离线时长: ${n}秒`}return e.jsx(_,{delayDuration:100,children:e.jsxs(F,{children:[e.jsx(D,{children:e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:u("size-2.5 rounded-full ring-2 ring-offset-2",r?"bg-green-500 ring-green-500/20":"bg-gray-300 ring-gray-300/20","transition-all duration-300")}),e.jsx("span",{className:"font-medium text-foreground/90",children:s.original.email})]})}),e.jsx(M,{side:"bottom",className:"max-w-[280px]",children:e.jsx("p",{className:"whitespace-pre-line text-sm",children:l})})]})})},enableSorting:!1,enableHiding:!1},{accessorKey:"banned",header:({column:s})=>e.jsx(o,{column:s,title:"状态"}),cell:({row:s})=>{const a=s.original.banned;return e.jsx("div",{className:"flex justify-center",children:e.jsx(j,{className:u("min-w-20 justify-center transition-colors",a?"bg-destructive/15 text-destructive hover:bg-destructive/25":"bg-success/15 text-success hover:bg-success/25"),children:qe[a]})})},enableSorting:!0,filterFn:(s,a,r)=>r.includes(s.getValue(a))},{accessorKey:"plan.name",header:({column:s})=>e.jsx(o,{column:s,title:"订阅"}),cell:({row:s})=>e.jsx("div",{className:"min-w-[10em] break-all",children:s.original?.plan?.name||"-"}),enableSorting:!1,enableHiding:!1},{accessorKey:"group",header:({column:s})=>e.jsx(o,{column:s,title:"权限组"}),cell:({row:s})=>e.jsx("div",{className:"flex flex-wrap gap-1",children:e.jsx(j,{variant:"outline",className:u("px-2 py-0.5 font-medium","bg-secondary/50 hover:bg-secondary/70","border border-border/50","transition-all duration-200","cursor-default select-none","flex items-center gap-1.5 whitespace-nowrap"),children:s.original?.group?.name||"-"})}),enableSorting:!1,filterFn:(s,a,r)=>{const n=s.getValue(a);return r.some(l=>n?.includes(l))}},{accessorKey:"total_used",header:({column:s})=>e.jsx(o,{column:s,title:"已用流量"}),cell:({row:s})=>{const a=S(s.original?.total_used),r=S(s.original?.transfer_enable),n=s.original?.total_used/s.original?.transfer_enable*100||0;return e.jsx(_,{delayDuration:100,children:e.jsxs(F,{children:[e.jsx(D,{className:"w-full",children:e.jsxs("div",{className:"w-full space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:a}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[n.toFixed(1),"%"]})]}),e.jsx("div",{className:"h-1.5 w-full rounded-full bg-secondary",children:e.jsx("div",{className:u("h-full rounded-full transition-all",n>90?"bg-destructive":"bg-primary"),style:{width:`${Math.min(n,100)}%`}})})]})}),e.jsx(M,{side:"bottom",children:e.jsxs("p",{className:"text-sm",children:["总流量配额: ",r]})})]})})}},{accessorKey:"transfer_enable",header:({column:s})=>e.jsx(o,{column:s,title:"总流量"}),cell:({row:s})=>e.jsx("div",{className:"font-medium text-muted-foreground",children:S(s.original?.transfer_enable)})},{accessorKey:"expired_at",header:({column:s})=>e.jsx(o,{column:s,title:"到期时间"}),cell:({row:s})=>{const a=s.original.expired_at,r=Date.now()/1e3,n=a!=null&&a<r,l=a?new Date(a*1e3):null,i=l?Math.ceil((l.getTime()-Date.now())/(1e3*60*60*24)):null;return e.jsx(_,{delayDuration:100,children:e.jsxs(F,{children:[e.jsx(D,{className:"block w-full",children:e.jsx(j,{variant:"outline",className:u("w-full justify-center transition-colors",n?"border-destructive/50 bg-destructive/10 text-destructive":a?"border-success/50 bg-success/10 text-success":"border-primary/50 bg-primary/10 text-primary"),children:a?w(a,"YYYY-MM-DD"):"永久有效"})}),e.jsx(M,{side:"bottom",className:"p-3 space-y-1",children:a?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["到期时间：",w(a)]}),e.jsx("p",{className:u("text-sm font-medium",n?"text-destructive":"text-success"),children:n?`已过期 ${Math.abs(i??0)} 天`:`剩余 ${i??0} 天`})]}):e.jsx("p",{className:"text-sm font-medium text-foreground",children:"永久有效"})})]})})}},{accessorKey:"balance",header:({column:s})=>e.jsx(o,{column:s,title:"余额"}),cell:({row:s})=>{const a=z(s.original?.balance);return e.jsxs("div",{className:"flex items-center gap-1 font-medium",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"¥"}),e.jsx("span",{className:"tabular-nums text-foreground",children:a})]})}},{accessorKey:"commission_balance",header:({column:s})=>e.jsx(o,{column:s,title:"佣金"}),cell:({row:s})=>{const a=z(s.original?.commission_balance);return e.jsxs("div",{className:"flex items-center gap-1 font-medium",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"¥"}),e.jsx("span",{className:"tabular-nums text-foreground",children:a})]})}},{accessorKey:"created_at",header:({column:s})=>e.jsx(o,{column:s,title:"注册时间"}),cell:({row:s})=>e.jsx("div",{className:"truncate",children:w(s.original?.created_at)}),size:1e3},{id:"actions",header:({column:s})=>e.jsx(o,{column:s,className:"justify-end",title:"操作"}),cell:({row:s,table:a})=>e.jsxs(te,{modal:!0,children:[e.jsx(re,{asChild:!0,children:e.jsx("div",{className:"text-end",children:e.jsx(m,{variant:"ghost",className:"h-8 w-8 p-0 hover:bg-muted","aria-label":"打开操作菜单",children:e.jsx(Je,{className:"size-4"})})})}),e.jsxs(ne,{align:"end",className:"min-w-[40px]",children:[e.jsx(h,{onSelect:r=>{r.preventDefault()},className:"p-0",children:e.jsx(Ge,{defaultValues:{...s.original,invite_user_email:s.original.invite_user?.email},refetch:t,dialogTrigger:e.jsxs(m,{variant:"ghost",className:"w-full justify-start px-2 py-1.5",children:[e.jsx(ls,{className:"mr-2"}),"编辑"]})})}),e.jsx(h,{onSelect:r=>r.preventDefault(),className:"p-0",children:e.jsx(Qe,{defaultValues:{email:s.original.email},trigger:e.jsxs(m,{variant:"ghost",className:"w-full justify-start px-2 py-1.5",children:[e.jsx(ts,{className:"mr-2 "}),"分配订单"]})})}),e.jsx(h,{onSelect:()=>{He(s.original.subscribe_url)},className:"p-0",children:e.jsxs(m,{variant:"ghost",className:"w-full justify-start px-2 py-1.5",children:[e.jsx(rs,{className:"mr-2"}),"复制订阅URL"]})}),e.jsx(h,{onSelect:()=>{Ke({id:s.original.id}).then(({data:r})=>{r&&H.success("重置成功")})},children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ns,{className:"mr-2 "}),"重置UUID及订阅URL"]})}),e.jsx(h,{onSelect:()=>{},className:"p-0",children:e.jsxs(G,{className:"flex items-center px-2 py-1.5",to:`/finance/order?user_id=${s.original?.id}`,children:[e.jsx(is,{className:"mr-2"}),"TA的订单"]})}),e.jsx(h,{onSelect:()=>{a.setColumnFilters([{id:"invite_user_id",value:s.original?.id}])},children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(os,{className:"mr-2 "}),"TA的邀请"]})}),e.jsx(h,{onSelect:r=>r.preventDefault(),className:"p-0",children:e.jsx(Ye,{user_id:s.original?.id,dialogTrigger:e.jsxs(m,{variant:"ghost",className:"w-full justify-start px-2 py-1.5",children:[e.jsx(cs,{className:"mr-2 "}),"TA的流量记录"]})})})]})]})}];function ms(){const[t]=Y(),[c,s]=d.useState({}),[a,r]=d.useState({}),[n,l]=d.useState([]),[i,p]=d.useState([]),[x,K]=d.useState({pageIndex:0,pageSize:10});d.useEffect(()=>{const y=t.get("email");y&&l(C=>C.some(q=>q.id==="email")?C:[...C,{id:"email",value:y}])},[t]);const{refetch:T,data:V,isLoading:us}=pe({queryKey:["userList",x,n,i],queryFn:()=>Ze({pageSize:x.pageSize,current:x.pageIndex+1,filter:n,sort:i})}),[O,Z]=d.useState([]);d.useEffect(()=>{Oe().then(({data:y})=>{Z(y)})},[]);const L=de({data:V?.data??[],columns:ds(T),state:{sorting:i,columnVisibility:a,rowSelection:c,columnFilters:n,pagination:x},rowCount:V?.total??0,manualPagination:!0,manualFiltering:!0,manualSorting:!0,enableRowSelection:!0,onRowSelectionChange:s,onSortingChange:p,onColumnFiltersChange:l,onColumnVisibilityChange:r,getCoreRowModel:me(),getFilteredRowModel:ue(),getPaginationRowModel:xe(),onPaginationChange:K,getSortedRowModel:he(),getFacetedRowModel:ge(),getFacetedUniqueValues:je(),initialState:{columnVisibility:{commission_balance:!1,created_at:!1},columnPinning:{right:["actions"]}}});return e.jsx(fe,{table:L,toolbar:e.jsx(as,{table:L,refetch:T,serverGroupList:O})})}function qs(){return e.jsxs(ie,{children:[e.jsxs(oe,{children:[e.jsx(se,{}),e.jsxs("div",{className:"ml-auto flex items-center space-x-4",children:[e.jsx(ae,{}),e.jsx(le,{})]})]}),e.jsxs(ce,{className:"flex flex-col",fixedHeight:!0,children:[e.jsx("div",{className:"mb-2 flex items-center justify-between space-y-2",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"用户管理"}),e.jsx("p",{className:"text-muted-foreground",children:"在这里可以管理用户，包括增加、删除、编辑、查询等操作。"})]})}),e.jsx("div",{className:"-mx-4 flex-1 overflow-auto px-4 py-1 lg:flex-row lg:space-x-12 lg:space-y-0",children:e.jsx("div",{className:"w-full",children:e.jsx(ms,{})})})]})]})}export{qs as default};
