import{r,j as s,a as x}from"./index-ra1jmRmU.js";import{c as ee,L as te,f as E,C as ne,w as se,b as re,e as le}from"./user-nav-Ch7kI57y.js";import{B as ue}from"./column-header-p2OHlx2E.js";/**
 * @license lucide-react v0.399.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=ee("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function oe(l,u){const[o,f]=r.useState(l);return r.useEffect(()=>{const a=setTimeout(()=>f(l),u);return()=>{clearTimeout(a)}},[l,u]),o}function I(l,u){if(l.length===0)return{};if(!u)return{"":l};const o={};return l.forEach(f=>{const a=f[u]||"";o[a]||(o[a]=[]),o[a].push(f)}),o}function ae(l,u){const o=JSON.parse(JSON.stringify(l));for(const[f,a]of Object.entries(o))o[f]=a.filter(y=>!u.find(c=>c.value===y.value));return o}function ie(l,u){for(const[,o]of Object.entries(l))if(o.some(f=>u.find(a=>a.value===f.value)))return!0;return!1}const X=r.forwardRef(({className:l,...u},o)=>te(a=>a.filtered.count===0)?s.jsx("div",{ref:o,className:x("py-6 text-center text-sm",l),"cmdk-empty":"",role:"presentation",...u}):null);X.displayName="CommandEmpty";const fe=r.forwardRef(({value:l,onChange:u,placeholder:o,defaultOptions:f=[],options:a,delay:y,onSearch:c,loadingIndicator:U,emptyIndicator:O,maxSelected:R=Number.MAX_SAFE_INTEGER,onMaxSelected:V,hidePlaceholderWhenSelected:S,disabled:h,groupBy:v,className:_,badgeClassName:z,selectFirstItem:H=!0,creatable:b=!1,triggerSearchOnFocus:D=!1,commandProps:d,inputProps:w,hideClearAllButton:$=!1},q)=>{const p=r.useRef(null),[M,T]=r.useState(!1),F=r.useRef(!1),[J,K]=r.useState(!1),[t,j]=r.useState(l||[]),[g,A]=r.useState(I(f,v)),[m,L]=r.useState(""),N=oe(m,y||500);r.useImperativeHandle(q,()=>({selectedValue:[...t],input:p.current,focus:()=>p.current?.focus()}),[t]);const C=r.useCallback(e=>{const n=t.filter(i=>i.value!==e.value);j(n),u?.(n)},[u,t]),B=r.useCallback(e=>{const n=p.current;n&&((e.key==="Delete"||e.key==="Backspace")&&n.value===""&&t.length>0&&(t[t.length-1].fixed||C(t[t.length-1])),e.key==="Escape"&&n.blur())},[C,t]);r.useEffect(()=>{l&&j(l)},[l]),r.useEffect(()=>{if(!a||c)return;const e=I(a||[],v);JSON.stringify(e)!==JSON.stringify(g)&&A(e)},[f,a,v,c,g]),r.useEffect(()=>{const e=async()=>{K(!0);const i=await c?.(N);A(I(i||[],v)),K(!1)};(async()=>{!c||!M||(D&&await e(),N&&await e())})()},[N,v,M,D]);const Q=()=>{if(!b||ie(g,[{value:m,label:m}])||t.find(n=>n.value===m))return;const e=s.jsx(E,{value:m,className:"cursor-pointer",onMouseDown:n=>{n.preventDefault(),n.stopPropagation()},onSelect:n=>{if(t.length>=R){V?.(t.length);return}L("");const i=[...t,{value:n,label:n}];j(i),u?.(i)},children:`Create "${m}"`});if(!c&&m.length>0||c&&N.length>0&&!J)return e},Y=r.useCallback(()=>{if(O)return c&&!b&&Object.keys(g).length===0?s.jsx(E,{value:"-",disabled:!0,children:O}):s.jsx(X,{children:O})},[b,O,c,g]),Z=r.useMemo(()=>ae(g,t),[g,t]),W=r.useCallback(()=>{if(d?.filter)return d.filter;if(b)return(e,n)=>e.toLowerCase().includes(n.toLowerCase())?1:-1},[b,d?.filter]),P=r.useCallback(()=>{const e=t.filter(n=>n.fixed);j(e),u?.(e)},[u,t]);return s.jsxs(ne,{...d,onKeyDown:e=>{B(e),d?.onKeyDown?.(e)},className:x("h-auto overflow-visible bg-transparent",d?.className),shouldFilter:d?.shouldFilter!==void 0?d.shouldFilter:!c,filter:W(),children:[s.jsx("div",{className:x("rounded-md border border-input text-sm ring-offset-background focus-within:ring-1 focus-within:ring-ring ",{"px-3 py-2":t.length!==0,"cursor-text":!h&&t.length!==0},_),onClick:()=>{h||p.current?.focus()},children:s.jsxs("div",{className:"flex flex-wrap gap-1",children:[t.map(e=>s.jsxs(ue,{className:x("data-[disabled]:bg-muted-foreground data-[disabled]:text-muted data-[disabled]:hover:bg-muted-foreground","data-[fixed]:bg-muted-foreground data-[fixed]:text-muted data-[fixed]:hover:bg-muted-foreground",z),"data-fixed":e.fixed,"data-disabled":h||void 0,children:[e.label,s.jsx("button",{className:x("ml-1 rounded-full outline-none ring-offset-background focus:ring-2 focus:ring-ring focus:ring-offset-2",(h||e.fixed)&&"hidden"),onKeyDown:n=>{n.key==="Enter"&&C(e)},onMouseDown:n=>{n.preventDefault(),n.stopPropagation()},onClick:()=>C(e),children:s.jsx(G,{className:"h-3 w-3 text-muted-foreground hover:text-foreground"})})]},e.value)),s.jsx(se.Input,{...w,ref:p,value:m,disabled:h,onValueChange:e=>{L(e),w?.onValueChange?.(e)},onBlur:e=>{F.current===!1&&T(!1),w?.onBlur?.(e)},onFocus:e=>{T(!0),D&&c?.(N),w?.onFocus?.(e)},placeholder:S&&t.length!==0?"":o,className:x("flex-1 bg-transparent outline-none placeholder:text-muted-foreground",{"w-full":S,"px-3 py-2":t.length===0,"ml-1":t.length!==0},w?.className)}),s.jsx("button",{type:"button",onClick:P,className:x(($||h||t.length<1||t.filter(e=>e.fixed).length===t.length)&&"hidden"),children:s.jsx(G,{})})]})}),s.jsx("div",{className:"relative",children:M&&s.jsx(re,{className:"absolute top-1 z-10 w-full rounded-md border bg-popover text-popover-foreground shadow-md outline-none animate-in",onMouseLeave:()=>{F.current=!1},onMouseEnter:()=>{F.current=!0},onMouseUp:()=>{p.current?.focus()},children:J?s.jsx(s.Fragment,{children:U}):s.jsxs(s.Fragment,{children:[Y(),Q(),!H&&s.jsx(E,{value:"-",className:"hidden"}),Object.entries(Z).map(([e,n])=>s.jsx(le,{heading:e,className:"h-full overflow-auto",children:s.jsx(s.Fragment,{children:n.map(i=>s.jsx(E,{value:i.value,disabled:i.disable,onMouseDown:k=>{k.preventDefault(),k.stopPropagation()},onSelect:()=>{if(t.length>=R){V?.(t.length);return}L("");const k=[...t,i];j(k),u?.(k)},className:x("cursor-pointer",i.disable&&"cursor-default text-muted-foreground"),children:i.label},i.value))})},e))]})})})]})});fe.displayName="MultipleSelector";export{fe as M,G as X};
