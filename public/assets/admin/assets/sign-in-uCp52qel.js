import{c as h,r as d,j as e,a as y,B as m,b as N,l as k,u as C,d as F,s as I,f as S,t as p}from"./index-ra1jmRmU.js";import{C as D}from"./card-m9i8rs49.js";import{u as E,F as M,a as x,b as u,c as g,d as f,e as j}from"./form-BdPgCkkB.js";import{z as l,t as z}from"./zod-DftZp2aV.js";import{I as T}from"./input-BJSapCFH.js";import"./clipboard-Bl2zvJsv.js";import{D as O,a as P,b as B,c as _,d as R,B as U}from"./button-BkBuHKqj.js";import"./index-QSXu8nGm.js";import"./index-OwEZQf1t.js";import"./index-CmmzV1O3.js";import"./react-icons.esm-BRv52UVg.js";var $=h("copy","IconCopy",[["path",{d:"M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z",key:"svg-0"}],["path",{d:"M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1",key:"svg-1"}]]),q=h("eye-off","IconEyeOff",[["path",{d:"M10.585 10.587a2 2 0 0 0 2.829 2.828",key:"svg-0"}],["path",{d:"M16.681 16.673a8.717 8.717 0 0 1 -4.681 1.327c-3.6 0 -6.6 -2 -9 -6c1.272 -2.12 2.712 -3.678 4.32 -4.674m2.86 -1.146a9.055 9.055 0 0 1 1.82 -.18c3.6 0 6.6 2 9 6c-.666 1.11 -1.379 2.067 -2.138 2.87",key:"svg-1"}],["path",{d:"M3 3l18 18",key:"svg-2"}]]),A=h("eye","IconEye",[["path",{d:"M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-0"}],["path",{d:"M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6",key:"svg-1"}]]);const v=d.forwardRef(({className:s,...r},i)=>{const[t,o]=d.useState(!1);return e.jsxs("div",{className:"relative rounded-md",children:[e.jsx("input",{type:t?"text":"password",className:y("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",s),ref:i,...r}),e.jsx(m,{type:"button",size:"icon",variant:"ghost",className:"absolute right-1 top-1/2 h-6 w-6 -translate-y-1/2 rounded-md text-muted-foreground",onClick:()=>o(a=>!a),children:t?e.jsx(A,{size:18}):e.jsx(q,{size:18})})]})});v.displayName="PasswordInput";const H=s=>N({url:"/passport/auth/login",method:"post",data:s}),K="access_token";function L(s){k.set(K,s)}const V=l.object({email:l.string().min(1,{message:"请输入邮箱地址"}).email({message:"邮箱地址格式不正确"}),password:l.string().min(1,{message:"请输入密码"}).min(7,{message:"密码长度至少为7个字符"})});function G({className:s,onForgotPassword:r,...i}){const t=C(),o=F(),a=E({resolver:z(V),defaultValues:{email:"",password:""}});async function w(c){try{const{data:n}=await H(c);n&&(L(n.auth_data),o(I(n.auth_data)),await o(S()).unwrap(),t("/"))}catch(n){const b=n instanceof Error?n.message:"登录失败";p.error(b)}}return e.jsx("div",{className:y("grid gap-6",s),...i,children:e.jsx(M,{...a,children:e.jsx("form",{onSubmit:a.handleSubmit(w),children:e.jsxs("div",{className:"grid gap-2",children:[e.jsx(x,{control:a.control,name:"email",render:({field:c})=>e.jsxs(u,{className:"space-y-1",children:[e.jsx(g,{children:"邮箱地址"}),e.jsx(f,{children:e.jsx(T,{placeholder:"name@example.com",...c})}),e.jsx(j,{})]})}),e.jsx(x,{control:a.control,name:"password",render:({field:c})=>e.jsxs(u,{className:"space-y-1",children:[e.jsx(g,{children:"密码"}),e.jsx(f,{children:e.jsx(v,{placeholder:"请输入密码",...c})}),e.jsx(j,{})]})}),e.jsx(m,{className:"mt-2",loading:a.formState.isSubmitting,children:"登录"}),e.jsx(m,{variant:"link",type:"button",className:"mt-1 text-sm text-muted-foreground hover:text-primary",onClick:r,children:"忘记密码？"})]})})})})}function oe(){const[s,r]=d.useState(!1),i=async o=>{try{await navigator.clipboard.writeText(o),p.success("命令已复制到剪贴板")}catch{p.error("复制失败，请手动复制")}},t="php artisan reset:password 管理员邮箱";return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"container grid h-svh flex-col items-center justify-center bg-primary-foreground lg:max-w-none lg:px-0",children:e.jsxs("div",{className:"mx-auto flex w-full flex-col justify-center space-y-2 sm:w-[480px] lg:p-8",children:[e.jsx("div",{className:"mb-4 flex items-center justify-center",children:e.jsx("h1",{className:"text-3xl font-medium",children:window?.settings?.title})}),e.jsxs(D,{className:"p-6",children:[e.jsxs("div",{className:"flex flex-col space-y-2 text-left",children:[e.jsx("h1",{className:"text-2xl font-semibold tracking-tight",children:"登录"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"请输入您的邮箱和密码登录系统"})]}),e.jsx(G,{onForgotPassword:()=>r(!0)})]})]})}),e.jsx(O,{open:s,onOpenChange:r,children:e.jsx(P,{children:e.jsxs(B,{children:[e.jsx(_,{children:"忘记密码"}),e.jsx(R,{children:"在站点目录下执行以下命令找回密码"}),e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:"relative",children:[e.jsx("pre",{className:"rounded-md bg-secondary p-4 pr-12",children:t}),e.jsx(U,{variant:"ghost",size:"icon",className:"absolute right-2 top-2 h-8 w-8 hover:bg-secondary-foreground/10",onClick:()=>i(t),children:e.jsx($,{className:"h-4 w-4"})})]})})]})})})]})}export{oe as default};
